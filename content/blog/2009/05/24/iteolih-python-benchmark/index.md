---
title: "Iteolih: Python Benchmark"
authors: ["Markus Koetter"]
date: "2009-05-24"
tags: 
  - "iteolih-d90"
  - "python-d32"
---

As the plan is to embedd python as scripting language into the honeypot, I ran a benchmark on a testsuite. The 'testsuite' is a c core which accepts connections, and allows python to deal with the input. The protocol used for benchmarking is http, the service serves a non static html page.

I tested

- - 2.6.2\_(release26-maint,\_Apr\_19\_2009,\_02:15:38)

- - 3.0.1+\_(r301:69556,\_Apr\_15\_2009,\_17:22:45)\_

- - 3.1a1+\_(py3k,\_Mar\_30\_2009,\_02:02:26)\_

To benchmark, I ran the apache benchmark tool **ab**

_ab -n 100000 -c 15 http://localhost:8080/bar_

The result:

<table style="border: 2px solid #000000;" border="2" frame="border" rules="none" cellspacing="0"><colgroup><col width="383"> <col width="71"> <col width="86"> <col width="86"> </colgroup><tbody><tr><td style="border: 1px solid #000000;" align="left">Server Software:</td><td style="border: 1px solid #000000;" align="left">2.6.2</td><td style="border: 1px solid #000000;" align="left">3.0.1</td><td style="border: 1px solid #000000;" align="left">3.1a</td></tr><tr><td style="border: 1px solid #000000;" align="left">Server Hostname:</td><td style="border: 1px solid #000000;" align="left">localhost</td><td style="border: 1px solid #000000;" align="left">localhost</td><td style="border: 1px solid #000000;" align="left">localhost</td></tr><tr><td style="border: 1px solid #000000;" align="left">Server Port:</td><td style="border: 1px solid #000000;" align="left">8080</td><td style="border: 1px solid #000000;" align="left">8080</td><td style="border: 1px solid #000000;" align="left">8080</td></tr><tr><td style="border: 1px solid #000000;" align="left">Document Path:</td><td style="border: 1px solid #000000;" align="left">/bar</td><td style="border: 1px solid #000000;" align="left">/bar</td><td style="border: 1px solid #000000;" align="left">/bar</td></tr><tr><td style="border: 1px solid #000000;" align="left">Document Length:</td><td style="border: 1px solid #000000;" align="left">191 bytes</td><td style="border: 1px solid #000000;" align="left">191 bytes</td><td style="border: 1px solid #000000;" align="left">191 bytes</td></tr><tr><td style="border: 1px solid #000000;" align="left">Concurrency Level:</td><td style="border: 1px solid #000000;" align="left">15</td><td style="border: 1px solid #000000;" align="left">15</td><td style="border: 1px solid #000000;" align="left">15</td></tr><tr><td style="border: 1px solid #000000;" align="left">Time taken for tests: (seconds)</td><td style="border: 1px solid #000000;" align="left"><span style="color: #00ff00;"><em>28.47</em></span></td><td style="border: 1px solid #000000;" align="left"><span style="color: #ff0000;"><strong>102.15</strong></span></td><td style="border: 1px solid #000000;" align="left">31.8</td></tr><tr><td style="border: 1px solid #000000;" align="left">Complete requests:</td><td style="border: 1px solid #000000;" align="left">100000</td><td style="border: 1px solid #000000;" align="left">100000</td><td style="border: 1px solid #000000;" align="left">100000</td></tr><tr><td style="border: 1px solid #000000;" align="left">Failed requests:</td><td style="border: 1px solid #000000;" align="left">0</td><td style="border: 1px solid #000000;" align="left">0</td><td style="border: 1px solid #000000;" align="left">0</td></tr><tr><td style="border: 1px solid #000000;" align="left">Write errors:</td><td style="border: 1px solid #000000;" align="left">0</td><td style="border: 1px solid #000000;" align="left">0</td><td style="border: 1px solid #000000;" align="left">0</td></tr><tr><td style="border: 1px solid #000000;" align="left">Total transferred: (bytes)</td><td style="border: 1px solid #000000;" align="left">38600386</td><td style="border: 1px solid #000000;" align="left">38200000</td><td style="border: 1px solid #000000;" align="left">37600376</td></tr><tr><td style="border: 1px solid #000000;" align="left">HTML transferred: (bytes)</td><td style="border: 1px solid #000000;" align="left">19100191</td><td style="border: 1px solid #000000;" align="left">19100000</td><td style="border: 1px solid #000000;" align="left">19100191</td></tr><tr><td style="border: 1px solid #000000;" align="left">Requests per second: [#sec] (mean)</td><td style="border: 1px solid #000000;" align="left"><span style="color: #00ff00;"><em>3512.04</em></span></td><td style="border: 1px solid #000000;" align="left"><span style="color: #ff0000;"><strong>978.95</strong></span></td><td style="border: 1px solid #000000;" align="left">3144.45</td></tr><tr><td style="border: 1px solid #000000;" align="left">Time per request: [ms] (mean)</td><td style="border: 1px solid #000000;" align="left">4.27</td><td style="border: 1px solid #000000;" align="left">15.32</td><td style="border: 1px solid #000000;" align="left">4.77</td></tr><tr><td style="border: 1px solid #000000;" align="left">Time per request: [ms] (mean, across all concurrent requests)</td><td style="border: 1px solid #000000;" align="left">0.29</td><td style="border: 1px solid #000000;" align="left">1.02</td><td style="border: 1px solid #000000;" align="left">0.32</td></tr><tr><td style="border: 1px solid #000000;" align="left">Transfer rate: [Kbytes/sec] received</td><td style="border: 1px solid #000000;" align="left"><span style="color: #00ff00;"><em>1323.89</em></span></td><td style="border: 1px solid #000000;" align="left"><span style="color: #ff0000;"><strong>365.19</strong></span></td><td style="border: 1px solid #000000;" align="left">1154.61</td></tr></tbody></table>

Python 3.0.1 serves about 978 requests per second, where Python 2.6.2 does 3512 requests/second.

<table style="border: 2px solid #000000;" border="2" frame="void" rules="none" cellspacing="0"><colgroup><col width="383"> <col width="71"> <col width="86"> <col width="86"> </colgroup><tbody><tr><td style="border: 1px solid #000000;" align="right">Percentage of the requests served within a certain time (ms)</td><td style="border: 1px solid #000000;" align="right">2.6.2</td><td style="border: 1px solid #000000;" align="right">3.0.1</td><td style="border: 1px solid #000000;" align="right">3.1a</td></tr><tr><td style="border: 1px solid #000000;" align="right">50.00%</td><td style="border: 1px solid #000000;" align="right">3</td><td style="border: 1px solid #000000;" align="right">15</td><td style="border: 1px solid #000000;" align="right">4</td></tr><tr><td style="border: 1px solid #000000;" align="right">66.00%</td><td style="border: 1px solid #000000;" align="right">4</td><td style="border: 1px solid #000000;" align="right">15</td><td style="border: 1px solid #000000;" align="right">5</td></tr><tr><td style="border: 1px solid #000000;" align="right">75.00%</td><td style="border: 1px solid #000000;" align="right">4</td><td style="border: 1px solid #000000;" align="right">15</td><td style="border: 1px solid #000000;" align="right">5</td></tr><tr><td style="border: 1px solid #000000;" align="right">80.00%</td><td style="border: 1px solid #000000;" align="right">4</td><td style="border: 1px solid #000000;" align="right">16</td><td style="border: 1px solid #000000;" align="right">5</td></tr><tr><td style="border: 1px solid #000000;" align="right">90.00%</td><td style="border: 1px solid #000000;" align="right">4</td><td style="border: 1px solid #000000;" align="right">16</td><td style="border: 1px solid #000000;" align="right">5</td></tr><tr><td style="border: 1px solid #000000;" align="right">95.00%</td><td style="border: 1px solid #000000;" align="right">5</td><td style="border: 1px solid #000000;" align="right">16</td><td style="border: 1px solid #000000;" align="right">5</td></tr><tr><td style="border: 1px solid #000000;" align="right">98.00%</td><td style="border: 1px solid #000000;" align="right">5</td><td style="border: 1px solid #000000;" align="right">17</td><td style="border: 1px solid #000000;" align="right">6</td></tr><tr><td style="border: 1px solid #000000;" align="right">99.00%</td><td style="border: 1px solid #000000;" align="right">6</td><td style="border: 1px solid #000000;" align="right">19</td><td style="border: 1px solid #000000;" align="right">6</td></tr><tr><td style="border: 1px solid #000000;" align="right">100% (longest request)</td><td style="border: 1px solid #000000;" align="right">3004</td><td style="border: 1px solid #000000;" align="right">3019</td><td style="border: 1px solid #000000;" align="right">3006</td></tr></tbody></table>

![](images/drupal_image_443.jpg)

Obviously Python 3.0 does something wrong, talking about factor 4x, it is noticeably slower. But I'mÂ  glad to see it is fixed in 3.1 already.

I tried to benchmark using unladen-swallow, the llvm based python project run by google, but was not able to link the code properly. (undefined symbol: \_ZTIN4llvm14ModuleProviderE)

As Python 3.1a is almost as fast as 2.6 for our needs, and it can be tricky to port python 2.6 code to 3.x, we will use python 3 as embedded scripting language.
